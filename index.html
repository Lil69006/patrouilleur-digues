<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Bouton d'Urgence</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f0f0f0;
        }
        
        .emergency-button {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            padding: 20px 40px;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin-bottom: 20px;
            animation: pulse 2s infinite;
        }
        
        .emergency-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.4);
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 10px rgba(231, 76, 60, 0.5); }
            50% { box-shadow: 0 0 20px rgba(231, 76, 60, 0.8); }
            100% { box-shadow: 0 0 10px rgba(231, 76, 60, 0.5); }
        }
        
        .debug-log {
            background: white;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            font-family: monospace;
            font-size: 12px;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #ddd;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
        }
        
        .modal-content {
            background: #e74c3c;
            color: white;
            margin: 15% auto;
            padding: 30px;
            border-radius: 15px;
            width: 80%;
            max-width: 500px;
            text-align: center;
        }
        
        .close-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid white;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px;
        }
    </style>
</head>
<body>
    <h1>üö® Test Bouton d'Urgence</h1>
    
    <!-- Test 1: Bouton avec onclick direct -->
    <button onclick="testFunction1()" class="emergency-button">
        TEST 1: Bouton avec onclick="testFunction1()"
    </button>
    
    <!-- Test 2: Bouton avec ID et addEventListener -->
    <button id="testButton2" class="emergency-button">
        TEST 2: Bouton avec addEventListener
    </button>
    
    <!-- Test 3: Bouton simple avec alert -->
    <button onclick="alert('Test 3 fonctionne!')" class="emergency-button">
        TEST 3: Bouton avec alert simple
    </button>
    
    <!-- Test 4: Le bouton d'urgence original -->
    <button id="emergencyButton" class="emergency-button">
        üö® BOUTON D'URGENCE ORIGINAL üö®
    </button>
    
    <div class="debug-log" id="debugLog">
üìã LOG DE D√âBOGAGE:
- Page charg√©e
    </div>
    
    <!-- Modal d'urgence -->
    <div id="emergencyModal" class="modal">
        <div class="modal-content">
            <h2>üö® ALERTE D'URGENCE üö®</h2>
            <p>Test r√©ussi ! Le bouton fonctionne.</p>
            <button class="close-btn" onclick="closeModal()">Fermer</button>
        </div>
    </div>

    <script>
        // Fonction de log pour d√©boguer
        function debugLog(message) {
            const now = new Date().toLocaleTimeString();
            const logDiv = document.getElementById('debugLog');
            logDiv.textContent += `\n[${now}] ${message}`;
            logDiv.scrollTop = logDiv.scrollHeight;
            console.log(`[DEBUG] ${message}`);
        }
        
        // Test 1: Fonction simple
        function testFunction1() {
            debugLog('‚úÖ TEST 1 R√âUSSI: onclick direct fonctionne');
            alert('Test 1 r√©ussi !');
        }
        
        // Test 2: Fonction avec addEventListener
        function testFunction2() {
            debugLog('‚úÖ TEST 2 R√âUSSI: addEventListener fonctionne');
            alert('Test 2 r√©ussi !');
        }
        
        // Fonction d'urgence originale
        function handleEmergencyIncident() {
            debugLog('üö® FONCTION D\'URGENCE APPEL√âE!');
            
            try {
                // Afficher la modal
                document.getElementById('emergencyModal').style.display = 'block';
                debugLog('‚úÖ Modal d\'urgence affich√©e');
                
                // Vibration si disponible
                if (navigator.vibrate) {
                    navigator.vibrate([200, 100, 200]);
                    debugLog('üì≥ Vibration d√©clench√©e');
                } else {
                    debugLog('‚ùå Vibration non support√©e');
                }
                
                // Son d'alerte
                try {
                    playAlertSound();
                    debugLog('üîä Son d\'alerte jou√©');
                } catch (e) {
                    debugLog('‚ùå Son d\'alerte √©chou√©: ' + e.message);
                }
                
            } catch (error) {
                debugLog('‚ùå ERREUR dans handleEmergencyIncident: ' + error.message);
                alert('Erreur: ' + error.message);
            }
        }
        
        // Son d'alerte simple
        function playAlertSound() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
            oscillator.type = 'sine';
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.linearRampToValueAtTime(0, audioContext.currentTime + 0.2);
            
            oscillator.start();
            oscillator.stop(audioContext.currentTime + 0.2);
        }
        
        // Fermer modal
        function closeModal() {
            document.getElementById('emergencyModal').style.display = 'none';
            debugLog('‚ùå Modal ferm√©e');
        }
        
        // Initialisation imm√©diate
        debugLog('üöÄ Script JavaScript charg√©');
        
        // Test imm√©diat des √©l√©ments
        setTimeout(() => {
            debugLog('üîç Test de pr√©sence des √©l√©ments:');
            
            const btn1 = document.querySelector('[onclick="testFunction1()"]');
            const btn2 = document.getElementById('testButton2');
            const btn3 = document.querySelector('[onclick="alert(\'Test 3 fonctionne!\')"]');
            const btnEmergency = document.getElementById('emergencyButton');
            
            debugLog(`- Bouton Test 1: ${btn1 ? '‚úÖ Trouv√©' : '‚ùå Non trouv√©'}`);
            debugLog(`- Bouton Test 2: ${btn2 ? '‚úÖ Trouv√©' : '‚ùå Non trouv√©'}`);
            debugLog(`- Bouton Test 3: ${btn3 ? '‚úÖ Trouv√©' : '‚ùå Non trouv√©'}`);
            debugLog(`- Bouton Urgence: ${btnEmergency ? '‚úÖ Trouv√©' : '‚ùå Non trouv√©'}`);
            
            // Attacher l'√©v√©nement au bouton 2
            if (btn2) {
                btn2.addEventListener('click', testFunction2);
                debugLog('‚úÖ addEventListener attach√© au bouton 2');
            }
            
            // Attacher l'√©v√©nement au bouton d'urgence
            if (btnEmergency) {
                debugLog('üîß Tentative d\'attachement du bouton d\'urgence...');
                
                btnEmergency.addEventListener('click', function() {
                    debugLog('üö® CLICK D√âTECT√â sur le bouton d\'urgence!');
                    handleEmergencyIncident();
                });
                
                debugLog('‚úÖ Bouton d\'urgence configur√© avec addEventListener');
                
                // Test suppl√©mentaire avec onclick
                btnEmergency.onclick = function() {
                    debugLog('üö® ONCLICK D√âTECT√â sur le bouton d\'urgence!');
                    handleEmergencyIncident();
                };
                
                debugLog('‚úÖ Bouton d\'urgence configur√© avec onclick');
            } else {
                debugLog('‚ùå ERREUR: Bouton d\'urgence non trouv√© dans le DOM');
            }
            
        }, 100);
        
        // Test de toutes les fonctions
        setTimeout(() => {
            debugLog('üß™ Test des fonctions:');
            
            try {
                if (typeof testFunction1 === 'function') {
                    debugLog('‚úÖ testFunction1 d√©finie');
                } else {
                    debugLog('‚ùå testFunction1 non d√©finie');
                }
                
                if (typeof testFunction2 === 'function') {
                    debugLog('‚úÖ testFunction2 d√©finie');
                } else {
                    debugLog('‚ùå testFunction2 non d√©finie');
                }
                
                if (typeof handleEmergencyIncident === 'function') {
                    debugLog('‚úÖ handleEmergencyIncident d√©finie');
                } else {
                    debugLog('‚ùå handleEmergencyIncident non d√©finie');
                }
                
            } catch (e) {
                debugLog('‚ùå Erreur lors du test des fonctions: ' + e.message);
            }
            
        }, 200);
        
        debugLog('üèÅ Fin du script d\'initialisation');
    </script>
</body>
</html>
